/**
 * @license
 * Copyright (c) 2014, 2020, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 * @ignore
 */
define(["accUtils","knockout","ojs/ojbootstrap","ojs/ojcore","jquery","ojs/ojarraydataprovider","ojs/ojknockout-keyset","ojs/ojknockout","ojs/ojtable","ojs/ojcheckboxset","ojs/ojlabel","ojs/ojbutton","ojs/ojdialog","ojs/ojinputtext","ojs/ojchart","ojs/ojavatar"],(function(e,t,a,n,o,s,r){return function(){var e=this,a=[],n=[];function c(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}function l(e){return e.charAt(0).toUpperCase()+e.slice(1)}var h="https://pokeapi.co/api/v2/pokemon/";for(i=0;i<5;i++)d(h.concat(c(1,964)));function d(t){o.getJSON(t).then((function(t){var a=t.types.length,o=[];for(i=0;i<a;i++){var s=l(JSON.stringify(t.types[i].type.name).substring(1,JSON.stringify(t.types[i].type.name).length-1));i<a-1&&(s=s.concat(", ")),o+=s}var r=t.abilities.length,c=[];for(i=0;i<r;i++){s=l(JSON.stringify(t.abilities[i].ability.name).substring(1,JSON.stringify(t.abilities[i].ability.name).length-1));i<r-1&&(s=s.concat(", ")),c+=s}var h=t.game_indices.length,d=[];for(i=0;i<h;i++){s=l(JSON.stringify(t.game_indices[i].version.name).substring(1,JSON.stringify(t.game_indices[i].version.name).length-1));i<h-1&&(s=s.concat(", ")),d+=s}var u=t.held_items.length,g=[];for(i=0;i<u;i++){s=l(JSON.stringify(t.held_items[i].item.name).substring(1,JSON.stringify(t.held_items[i].item.name).length-1));i<u-1&&(s=s.concat(", ")),g+=s}var m=t.stats.length,f=[];for(i=0;i<m;i++){s=l(JSON.stringify(t.stats[i].stat.name).substring(1,JSON.stringify(t.stats[i].stat.name).length-1));i<m-1&&(s=s.concat(", ")),f+=s}n.push({PokeId:t.id,PokeName:l(t.name),PokeHeight:t.weight,PokeWeight:t.height,PokeMoves:t.moves.length,PokeTypes:o,PokeAbilities:c,PokeExperience:t.base_experience,PokeGame:d,PokeItems:g,PokeStats:f}),e.data(n)})).fail((function(e,t,i){d(h.concat(c(1,964)))}))}e.data=t.observableArray(),e.itemSelected=t.observable(!1),e.chartDataProvider=t.observableArray([]),e.dataProvider=new s(e.data,{keyAttributes:"PokeId"}),this.selectedItems=new r.ObservableKeySet,this.headerCheckStatus=t.observable(),this.handleCheckbox=function(e){return this.selectedItems().has(e)?["checked"]:[]}.bind(this),this.checkboxListener=function(t){chartData=[];var i=Number(t.target.dataset.rowKey);a.indexOf(i)>=0?a.splice(a.indexOf(i),1):a.push(i);var o=[],s=new Map;a.forEach(e=>{n.find(t=>t.PokeId===e).PokeTypes.split(",").map((function(e){return e.trim()})).forEach(e=>{s.get(e)?s.set(e,s.get(e)+1):s.set(e,1)}),o.push(n.find(t=>t.PokeId===e))}),5!=a.length?this.headerCheckStatus([]):5==a.length&&this.headerCheckStatus(["checked"]);for(let[e,t]of s)chartData.push({items:[t],name:e});e.chartDataProvider(chartData),chartData.length>0?e.itemSelected(!0):e.itemSelected(!1)}.bind(this),this.headerCheckboxListener=function(e){if(null!=e.detail){var t=e.detail.value;t.length>0?this.selectedItems.addAll():0===t.length&&"internal"==e.detail.updatedFrom&&this.selectedItems.clear()}}.bind(this),this.selectionListener=function(e){var t=e.detail.value.row;t.isAddAll()?t.deletedValues().size>0?this.headerCheckStatus([]):this.headerCheckStatus(["checked"]):this.headerCheckStatus([]),this.printCurrentSelection(t)}.bind(this),this.printCurrentSelection=function(e){var t="";if(e.isAddAll()){var i=e.deletedValues();i.forEach((function(e){t=0===t.length?e:t+", "+e})),i.size>0&&(t=" except "+t),t="Everything selected"+t}else e.values().forEach((function(e){t=0===t.length?e:t+", "+e}));document.getElementById("selectionCurrent")&&(document.getElementById("selectionCurrent").value=t)},this.showCreateDialog=function(e,t,i){var a=i.cell.row.PokeId,o=n.find(e=>e.PokeId===a);document.getElementById("createDialog").open(),output="Base_Experience : ".bold()+o.PokeExperience+"&"+"Abilities : ".bold()+o.PokeAbilities+"&"+"Game_Indices : ".bold()+o.PokeGame+"&"+"Held Items : ".bold()+o.PokeItems+"&"+"Stats : ".bold()+o.PokeStats,document.getElementById("viewCurrent").innerHTML=output.replace(/&/g,"<br/>");var s="https://img.pokemondb.net/artwork/large/"+i.cell.row.PokeName.toLowerCase()+".jpg";document.getElementById("imageId").src=s},e.closeItem=function(e,t){document.getElementById("createDialog").close()}}}));